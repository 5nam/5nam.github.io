---
layout: single
title:  "[세미나] 우아한테크세미나(2019), TDD 리팩토링"
published : true
categories: etc
toc: true
author_profile: false
sidebar:
    nav: "docs"
---

# 우아한테크세미나, TDD 리팩토링 - 우아한형제들, 박재성

## 1. 의식적인 연습이란?

TDD, 리팩토링을 잘하려면, 연습을 많이 한다고 실력이 늘까?

무의식적인 연습은 역량이 좋아지지 않는다.

- 테스트하기 쉬운 코드와 테스트하기 어려운 코드를 보는 눈

- 테스트하기 어려운 코드를 테스트 하기 쉬운 코드로 설계하는 감

이런 것이 중요한데, 쉽게 연습할 수 있는 분야가 아님

**그렇다면 더 효과적으로 연습할 수 있는 방법은 없을까?**

목적의식 있는 연습이 중요하다.

의식적인 연습의 7가지 원칙

1. 효과적인 훈련 기법이 수립되어 있는 기술 연마
2. 개인의 컴포트 존을 벗어난 지점에서 진행, 자신의 현재 능력을 살짝 넘어간느 작업을 지속적으로 시도
3. 명확하고 구체적인 목표를 가지고 진행
4. 신중하고 계획적이다. 즉, 개인이 온전히 집중하고 '의식적'으로 행동할 것을 요구
5. 피드백과 피드백에 따른 행동 변경을 수반(ex. 짝 프로그래밍 등)
6. 효과적인 심적 표상을 만들어내는 한편으로 심적 표상에 의존
7. 기존에 습득한 기술의 특정 부분을 집중적으로 개선함으로써 발전시키고, 수정하는 과정을 수반

## 2. TDD. 리팩토링 적용 - 개인

TDD. 리팩토링 == 운동, 평생동안 연습하겠다는 마음가짐으로 시작

**시작하기 - 공부 시간 확보, 장난감 프로젝트 찾기**

- 주변 환경에 영향을 받지 않고 꾸준히 연습하기 위한 것

- 일정 수준이 되기까지 꾸준히 장난감 프로젝트로 연습해야 함. 회사 프로젝트로 시작하면 흐름이 깨지는 경우가 많음

- 꾸준히 하기 위해 작은 습관을 만드는 것이 굉장히 중요함

### 1단계) 단위 테스트 연습

- 내가 사용하는 API 사용법을 익히기 위한 학습 테스트에서 시작

  - 자바 String 클래스의 다양한 메소드 사용법
  - 자바 ArrayList에 데이터를 추가, 수정, 삭제하는 방법

  ![image-20241211004038021]({{site.url}}/images/2024-12-11-etc(5)/image-20241211004038021.png)

![image-20241211004108755]({{site.url}}/images/2024-12-11-etc(5)/image-20241211004108755.png)

**연습효과**

- 단위테스트 방법을 학습할 수 있다.
- 단위테스트 도구의 사용법을 익힐 수 있다.
- 사용하는 API 에 대한 학습 효과가 있다.

- 내가 구현하는 메소드 중 input 과 output 이 명확한 클래스 메소드에 대한 단위테스트 연습
- 알고리즘 공부한다면, 알고리즘 구현에 대한 검증을 단위 테스트로 하는 등

### 2단계) TDD 연습

- 단위 테스트가 익숙해졌을 경우 시작

- 난이도가 낮거나 자신에게 익숙한 문제로 TDD 연습해보는 것을 추천
- 웹, 모바일 UI, DB 에 의존관계를 가지지 않는 요구사항으로 연습

예시) 문자열 덧셈 계산기 요구사항

- 쉼표 또는 콜론을 구분자로 가지는 문자열을 전달하는 경우 구분자를 기준으로 분리한 각 숫자의 합을 반환

![image-20241211004628251]({{site.url}}/images/2024-12-11-etc(5)/image-20241211004628251.png)

![image-20241211004657666]({{site.url}}/images/2024-12-11-etc(5)/image-20241211004657666.png)

### 3단계) 메소드 분리 리팩토링

- 테스트 코드 건들지 않고, 메소드 리팩토링에 집중하기

- 그렇다면 어디를 리팩토링 해야 할지 막막할 수 있음

첫 번째 원칙) 한 메서드에 오직 한 단계의 들여쓰기만 한다.

두 번째 원칙) else 예약어를 쓰지 않는다.

세 번째 원칙) 메소드가 한 가지 일만 하도록 구현하기

- 메소드가 재활용할 수 있게 될 수 있도록 하는 것!

네 번째 원칙) compose method 패턴 적용

- 추상화 레벨을 맞추는 패턴인 것

![image-20241211005222484]({{site.url}}/images/2024-12-11-etc(5)/image-20241211005222484.png)

오른쪽이 처음 읽는 입장에서 더 편리함

한번에 모든 원칙을 지키면서 리팩토링하려고 하지 마라.

한번에 한 가지 명확하고 구체적인 목표를 가지고 해라.

### 3단계) 리팩터링 연습 - 클래스 분리

예시) 문자열 덧셈 계산기 요구사항

- 쉼표 또는 콜론을 구분자로 가지는 문자열을 전달하는 경우 구분자를 기준으로 분리한 각 숫자의 합을 반환
- 숫자 이외의 값 또는 음수를 전달하는 경우 RuntimeException 예외를 Thorw 한다.

테스트코드 하나 추가, 음수값일 경우 Exception 이 발생하는 코드 추가

원칙 1) 모든 원시값과 문자열을 포장한다.(클래스로 분리하는 것)

![image-20241211005628797]({{site.url}}/images/2024-12-11-etc(5)/image-20241211005628797.png)

**클랙스 분리 연습을 위해 활용할 수 있는 원칙**

1. 일급 콜렉션을 쓴다.

- 이 콜렉션 하나만을 변수로 가지는 클래스를 하나 생성하는 것
- 즉, 이 변수를 클래스로 한번 감싸는 것

2. 3개 이상의 인스턴스 변수를 가진 클래스를 쓰지 않는다.

- 인스턴스 변수를 3개 이상 가지지 않도록 연습하는 것

이런 식으로 정량적인 규칙을 가지면, 혼자 피드백 과정을 만들 수 있는 것

### 4단계) 장남감 프로젝트 난이도 높이기

리팩토링하기 좋은 연습 프로젝트

- 게임과 같이 요구사항이 명확한 프로그램으로 연습
- 의존관계(UI, 데이터베이스 등)가 없이 연습
- 약간은 복잡한 로직이 있는 프로그램

예시(단, UI 는 콘솔)

- 로또
- 사다리 타기
- 볼링 게임 점수판
- 체스 게임
- 지뢰 찾기 게임

### 5단계) 의존관계 추가를 통한 난이도 높이기

이때 필요한 역량

테스트하기 쉬운 코드와 테스트하기 어려운 코드를 보는 눈

테스트하기 어려운 코드를 테스트 하기 쉬운 코드로 설계하는 감

- 앞의 과정을 통해 테스트하기 쉬운 부분, 어려운 부분을 분리하는 능력이 생겼을 것

### 한 단계 더 나아가기

- 컴파일 에러를 최소화하면서 리팩토링하기
- ATDD 기반으로 응용 애플리케이션 개발하기
- 레거시 애플리케이션에 테스트 코드 추가해 리팩토링하기

**우리가 TDD. 리팩토링 적용이 실패하는 이유**

- TDD, 리팩토링 연습이 충분하지 않은 상태에서 "레거시 애플리케이션에 테스트 코드 추가해 리팩토링하기" 와 같은 높은 난이도에 바로 도전하는 것이기 때문

## 구체적인 연습 목표 찾기

- 앞에서 나온 원칙들은 다 아래 책들에서 나온 것

### 객체지향 생활체조 원칙(스트웍스 앤솔러지)

- 규칙 1 : 한 메서드에 오직 한 단계의 들여쓰기만 한다.
- 규칙 2 : else 예약어를 쓰지 않는다.
- 규칙 3 : 모든 원시값과 문자열을 포장한다.
- 규칙 4 : 한 줄에 점을 하나만 찍는다.
- 규칙 5 : 줄여쓰지 않는다.(축약 금지)
- 규칙 6 : 모든 엔티티를 작게 유지한다
- 규칙 7 : 3개 이상의 인스턴스 변수를 가진 클래스를 쓰지 않는다.
- 규칙 8 : 일급 콜렉션을 쓴다.
- 규칙 9 : 게터/세터/프로퍼티를 쓰지 않는다.

### 클린코드

- 메소드 인자 개수

메소드(함수)에서 이상적인 인자 개수는 0개이다. 다음음 1개, 다음은 2개이다. 3개는 가능한 피하는 편이 좋다. 4개 이상은 특별한 이유가 있어도 사용하면 안된다.

**이런 식으로 책에서 규칙들을 찾고, 이를 실천하는 것이다.**

![image-20241211002912347]({{site.url}}/images/2024-12-11-etc(5)/image-20241211002912347.png)