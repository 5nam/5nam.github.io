---
layout: single
title:  "[SPRING MVC] ì„œë¸”ë¦¿, JSP, MVC íŒ¨í„´"
categories: spring_mvc
toc: true
author_profile: false
---
# 3. ì„œë¸”ë¦¿, JSP, MVC íŒ¨í„´

ì „ì²´ ê³¼ì •

1. í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë§Œë“¤ê³ 
2. íšŒì› ì €ì¥/ì¡°íšŒ ê¸°ëŠ¥(ì„œë¸”ë¦¿) ë§Œë“¤ê³ 
3. íšŒì› ì €ì¥/ì¡°íšŒ ê¸°ëŠ¥(JSP, ì„œë¸”ë¦¿ì„ ê°œì„ í•˜ê¸° ìœ„í•´ ë“±ì¥) ë§Œë“¤ê³ 
4. MVC íŒ¨í„´ ê°œìš”(JSP ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ ë“±ì¥), ì ìš©, í•œê³„

## íšŒì› ê´€ë¦¬ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜

#### Member

```java
package hello.servlet.domain.member;

import lombok.Getter;
import lombok.Setter;

@Getter @Setter
public class Member {

    private Long id;
    private String username;
    private int age;

    public Member() {
    }

    public Member(String username, int age) {
        this.username = username;
        this.age = age;
    }
}
```

- id ëŠ” íšŒì› ì €ì¥ì†Œê°€ í• ë‹¹

#### MemberRepository

~~~java
package hello.servlet.domain.member;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * ë™ì‹œì„± ë¬¸ì œê°€ ê³ ë ¤ë˜ì–´ ìˆì§€ ì•ŠìŒ, ì‹¤ë¬´ì—ì„œëŠ” ConcurrentHashMap, AtomicLong ì‚¬ìš© ê³ ë ¤
 */
public class MemberRepository {

    private static Map<Long, Member> store = new HashMap<>();
    private static long sequence = 0L;

    private static final MemberRepository instance = new MemberRepository();

    public static MemberRepository getInstance() {
        return instance;
    }

  	// ì‹±ê¸€í†¤ ë§Œë“¤ ë•ŒëŠ” private ìœ¼ë¡œ ê¸°ë³¸ ìƒì„±ì ë§‰ì•„ì¤˜ì•¼ í•¨
    private MemberRepository() {

    }

    public Member save(Member member) {
        member.setId(++sequence);
        store.put(member.getId(), member);
        return member;
    }

    public Member findById(Long id) {
        return store.get(id);
    }

    public List<Member> findAll() {
        return new ArrayList<>(store.values());
    }

    public void clearStore() {
        store.clear();
    }
}

~~~

`private static Map<Long, Member> store = new HashMap<>();`
`private static long sequence = 0L;`

- staticìœ¼ë¡œ ìƒì„±í–ˆê¸° ë•Œë¬¸ì— MemberRepository ê°€ ì•„ë¬´ë¦¬ new ë¡œ ë§ì•„ë„ ë”± í•˜ë‚˜ë§Œ ìƒì„±

`private static final MemberRepository instance = new MemberRepository();`

- ì‹±ê¸€í†¤ íŒ¨í„´(í•˜ë‚˜ì˜ ê°ì²´ë§Œ ë§Œë“¤ì–´ì„œ ê³µìœ í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²ƒ)

`public List<Member> findAll() { return new ArrayList<>(store.values());}`

- ì´ë ‡ê²Œ ìƒˆë¡œìš´ ArrayList ì— ë‹´ì•„ì„œ ë„˜ê¸°ëŠ” ì´ìœ ëŠ” ì™¸ë¶€ë¡œë¶€í„° store ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ì„œ(ìƒˆë¡œ store ë¥¼ ë§Œë“¤ì–´ì„œ ë‚´ë³´ë‚´ë©´, ì‹¤ì œ ê°ì²´ì˜ ì£¼ì†Œê°’ì´ ë…¸ì¶œë˜ì§€ ì•Šìœ¼ë‹ˆê¹Œ)

- ë¬¼ë¡  ì´ë ‡ê²Œ í•´ë„, store ë‚´ë¶€ ê°’ì˜ ì£¼ì†Œê°’ì€ ë„˜ì–´ì•„ê¸° ë•Œë¬¸ì— Member ë¥¼ ì§ì ‘ ê°€ì ¸ì™€ì„œ ì•ˆì— ìˆëŠ” ê°’ì„ ìˆ˜ì •í•  ìˆ˜ëŠ” ìˆìŒ

íšŒì› ì €ì¥ì†ŒëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ ì ìš©(í˜„ì¬ëŠ” ìŠ¤í”„ë§ ì‚¬ìš©ì„ ì•ˆí•´ì„œ ìŠ¤í”„ë§ ë¹ˆë„ ì‚¬ìš© X)

ì‹±ê¸€í†¤ íŒ¨í„´ì€ ê°ì²´ë¥¼ ë‹¨ í•˜ë‚˜ë§Œ ìƒì„±í•´ì„œ ê³µìœ í•˜ë¯€ë¡œ ê¸°ë³¸ ìƒì„±ì private ìœ¼ë¡œ ë§‰ì•„ë‘ 

#### MemberRepositoryTest

```java
package hello.servlet.domain.member;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.Test;

import java.util.List;

import static org.junit.jupiter.api.Assertions.*;

class MemberRepositoryTest {

    MemberRepository memberRepository = MemberRepository.getInstance();

    @AfterEach
    void afterEach() {
        memberRepository.clearStore();
    }

    @Test
    void save() {
        // given
        Member member = new Member("hello", 20);
        // when
        Member savedMember = memberRepository.save(member);
        // then
        Member findMember = memberRepository.findById(savedMember.getId());
        Assertions.assertThat(findMember).isEqualTo(savedMember);
    }

    @Test
    void findAll() {
        // given
        Member member1 = new Member("member1", 20);
        Member member2 = new Member("member2", 30);

        memberRepository.save(member1);
        memberRepository.save(member2);

        // when
        List<Member> result = memberRepository.findAll();

        // then
        Assertions.assertThat(result.size()).isEqualTo(2);
        Assertions.assertThat(result).contains(member1, member2);
    }
}
```

@AfterEach

- Test ê°€ ëë‚˜ë©´ test ë¥¼ ê¹”ë”í•˜ê²Œ ì´ˆê¸°í™”í•˜ëŠ” ê²ƒ

`void afterEach() { memberRepository.clearStore();}`

- ê° **test í•¨ìˆ˜ì—ëŠ” ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì—** ì´ì „ì— ë‚¨ì•„ ìˆëŠ” ë°ì´í„°ë¡œ ì¸í•´ í…ŒìŠ¤íŠ¸ì— ë¬¸ì œ ë°œìƒí•  ìˆ˜ ìˆìŒ

given-when-then

- given : ì´ëŸ° ë°ì´í„°ê°€ ì£¼ì–´ì¡Œì„ ë•Œ
- when : ì´ëŸ° ê²Œ ìˆ˜í–‰ë˜ê³ 
- then : ê²°ê³¼ëŠ” ì´ë˜ì•¼ í•¨

## ì„œë¸”ë¦¿ìœ¼ë¡œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°

- ì„œë¸”ë¦¿ìœ¼ë¡œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°

#### MemberFormServlet - íšŒì› ë“±ë¡ í¼

```java
package hello.servlet.web.servlet;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;
import java.io.PrintWriter;

@WebServlet(name = "memberFormServlet", urlPatterns = "/servlet/members/new-form")
public class MemberFormServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        resp.setContentType("text/html");
        resp.setCharacterEncoding("utf-8");

        PrintWriter w = resp.getWriter();
        w.write(
                "<!DOCTYPE html>\n" +
                        "<html>\n" +
                        "<head>\n" +
                        " <meta charset=\"UTF-8\">\n" +
                        " <title>Title</title>\n" +
                        "</head>\n" +
                        "<body>\n" +
                        "<form action=\"/servlet/members/save\" method=\"post\">\n" +
                        " username: <input type=\"text\" name=\"username\" />\n" +
                        " age: <input type=\"text\" name=\"age\" />\n" +
                        " <button type=\"submit\">ì „ì†¡</button>\n" +
                        "</form>\n" +
                        "</body>\n" +
                        "</html>\n"
        );
    }
}

```

Form ìœ¼ë¡œ ì „ì†¡ì„ í•˜ë©´, POST '/servlet/members/save' ì´ë™í•˜ë„ë¡ í•¨(ìš”ì²­ì„ ë³´ë‚´ë„ë¡ í•¨)

#### MemberSaveServlet - íšŒì› ì €ì¥

~~~java
package hello.servlet.web.servlet;

import hello.servlet.domain.member.Member;
import hello.servlet.domain.member.MemberRepository;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;
import java.io.PrintWriter;

@WebServlet(name = "memberSaveServlet", urlPatterns = "/servlet/members/save")
public class MemberSaveServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        System.out.println("MemberSaveServlet.service");
        String username = req.getParameter("username");
        int age = Integer.parseInt(req.getParameter("age"));

        Member member = new Member(username, age);
        System.out.println("member = " + member);

        memberRepository.save(member);

        PrintWriter writer = resp.getWriter();
        writer.write(
                "<html>\n" +
                        "<head>\n" +
                        " <meta charset=\"UTF-8\">\n" +
                        "</head>\n" +
                        "<body>\n" +
                        "ì„±ê³µ\n" +
                        "<ul>\n" +
                        " <li>id="+member.getId()+"</li>\n" +
                        " <li>username="+member.getUsername()+"</li>\n" +
                        " <li>age="+member.getAge()+"</li>\n" +
                        "</ul>\n" +
                        "<a href=\"/index.html\">ë©”ì¸</a>\n" +
                        "</body>\n" +
                        "</html>"
        );
    }
}

~~~

ë™ì‘ ìˆœì„œ

1. íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí•´ì„œ Member ê°ì²´ë¥¼ ë§Œë“ ë‹¤.
2. Member ê°ì²´ë¥¼ MemberRepository ë¥¼ í†µí•´ì„œ ì €ì¥í•œë‹¤.
3. Member ê°ì²´ë¥¼ ì‚¬ìš©í•´ì„œ ê²°ê³¼ í™”ë©´ìš© HTML ì„ ë™ì ìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì‘ë‹µí•œë‹¤.

#### MemberListServlet - íšŒì› ëª©ë¡

~~~java
package hello.servlet.web.servlet;

import hello.servlet.domain.member.Member;
import hello.servlet.domain.member.MemberRepository;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.List;

@WebServlet(name = "memberListServlet", urlPatterns = "/servlet/members")
public class MemberListServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        resp.setContentType("text/html");
        resp.setCharacterEncoding("utf-8");

        List<Member> members = memberRepository.findAll();

        PrintWriter writer = resp.getWriter();
        writer.write("<html>");
        writer.write("<head>");
        writer.write(" <meta charset=\"UTF-8\">");
        writer.write(" <title>Title</title>");
        writer.write("</head>");
        writer.write("<body>");
        writer.write("<a href=\"/index.html\">ë©”ì¸</a>");
        writer.write("<table>");
        writer.write(" <thead>");
        writer.write(" <th>id</th>");
        writer.write(" <th>username</th>");
        writer.write(" <th>age</th>");
        writer.write(" </thead>");
        writer.write(" <tbody>");

        // ë™ì ìœ¼ë¡œ í• ë‹¹í•˜ëŠ” ë¶€ë¶„
        for (Member member : members) {
            writer.write(" <tr>");
            writer.write(" <td>" + member.getId() + "</td>");
            writer.write(" <td>" + member.getUsername() + "</td>");
            writer.write(" <td>" + member.getAge() + "</td>");
            writer.write(" </tr>");
        }
        
        writer.write(" </tbody>");
        writer.write("</table>");
        writer.write("</body>");
        writer.write("</html>");
    }
}

~~~

MemberListServlet ë™ì‘ ìˆœì„œ

1. memberRepository.findAll() ì„ í†µí•´ ëª¨ë“  íšŒì›ì„ ì¡°íšŒ
2. íšŒì› ëª©ë¡ HTML ì„ for ë£¨í”„ í†µí•´ì„œ íšŒì› ìˆ˜ ë§Œí¼ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ê³  ì‘ë‹µ



**í…œí”Œë¦¿ ì—”ì§„**

ì„œë¸”ë¦¿ìœ¼ë¡œë§Œ HTML ê¹Œì§€ ë§Œë“œëŠ” ê²ƒì€ ë§¤ìš° ë³µì¡í•˜ê³  ë¹„íš¨ìœ¨ì ì„

ìë°” ì½”ë“œë¡œ HTML ì„ ë§Œë“¤ì–´ ë‚´ëŠ” ê²ƒ ë³´ë‹¤ ì°¨ë¼ë¦¬ HTML ë¬¸ì„œì— ë™ì ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ë§Œ ìë°” ì½”ë“œë¥¼ ë„£ëŠ” ê²ƒì´ ë” í¸ë¦¬í•  ê²ƒ

:arrow_right: ì´ê²ƒì´ í…œí”Œë¦¿ ì—”ì§„ì´ ë‚˜ì˜¨ ì´ìœ 

ì¢…ë¥˜ : JSP, Thymeleaf(ìŠ¤í”„ë§ê³¼ ì˜ í†µí•©ë˜ì–´ ì£¼ë¡œ ì“°ì„)


## JSP ë¡œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°

#### íšŒì› ë“±ë¡ í¼ JSP

~~~jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Title</title>
</head>
<body>

<form action="/jsp/members/save.jsp" method="post">
  username: <input type="text" name="username" />
  age: <input type="text" name="age" />
  <button type="submit">ì „ì†¡</button>
</form>

</body>
</html>

~~~

`<%@ page contentType="text/html;charset=UTF-8" language="java" %>`

- JSP ë¬¸ì„œë¼ëŠ” ê±¸ ë‚˜íƒ€ë‚´ëŠ” ê²ƒ(JSP ëŠ” í•­ìƒ ì´ë ‡ê²Œ ì‹œì‘)
- JSP ëŠ” ì„œë²„ ë‚´ë¶€ì—ì„œ ì„œë¸”ë¦¿ìœ¼ë¡œ ë³€í™˜ë˜ëŠ”ë°, MemberFormServlet ê³¼ ê±°ì˜ ë¹„ìŠ·í•œ ëª¨ìŠµìœ¼ë¡œ ë³€í™˜

#### íšŒì› ì €ì¥ JSP

```jsp
<%@ page import="hello.servlet.domain.member.MemberRepository" %>
<%@ page import="hello.servlet.domain.member.Member" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%

  // request, response ì‚¬ìš© ê°€ëŠ¥
  MemberRepository memberRepository = MemberRepository.getInstance();

  System.out.println("save.jsp");
  String username = request.getParameter("username");
  int age = Integer.parseInt(request.getParameter("age"));

  Member member = new Member(username, age);
  System.out.println("member = " + member);
  memberRepository.save(member);

%>
<html>
<head>
    <title>Title</title>
</head>
<body>
ì„±ê³µ
<ul>
  <li>id=<%=member.getId()%></li>
  <li>username=<%=member.getUsername()%></li>
  <li>age=<%=member.getAge()%></li>
</ul>
<a href="/index.html">ë©”ì¸</a>
</body>
</html>
```

request, response ì‚¬ìš© ê°€ëŠ¥

- ì´ìœ ëŠ” jsp ë„ ê²°êµ­ì€ servlet ìœ¼ë¡œ ë³€í™˜ë˜ê¸° ë•Œë¬¸ì—, service ë¡œì§ì´ ê·¸ëŒ€ë¡œ í˜¸ì¶œëœë‹¤ê³  ì´í•´í•˜ê¸°

`<%@ page import="hello.servlet.domain.member.MemberRepository" %>`

- JAVA ì˜ import ë¬¸

`<% ~~ %>`

- ì´ ë¶€ë¶„ì— JAVA ì½”ë“œ ì…ë ¥ ê°€ëŠ¥

`<%= ~~ %>`

`id=<%=member.getId()%>`

- ì´ ë¶€ë¶„ì—ëŠ” JAVA ì½”ë“œë¥¼ ì¶œë ¥ ê°€ëŠ¥

#### íšŒì› ëª©ë¡ JSP

```jsp
<%--
  Created by IntelliJ IDEA.
  User: onam-ui
  Date: 9/14/24
  Time: 5:44â€¯PM
  To change this template use File | Settings | File Templates.
--%>
<%@ page import="java.util.List" %>
<%@ page import="hello.servlet.domain.member.MemberRepository" %>
<%@ page import="hello.servlet.domain.member.Member" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%
    MemberRepository memberRepository = MemberRepository.getInstance();
    List<Member> members = memberRepository.findAll();
%>
<html>
<head>
    <title>Title</title>
</head>
<body>
    <a href="/index.html">ë©”ì¸</a>
    <table>
        <thead>
            <th>id</th>
            <th>username</th>
            <th>age</th>
        </thead>
        <tbody>
        <%
          	// out ë„ ê·¸ëƒ¥ ìŠ¬ ìˆ˜ ìˆëŠ” ì˜ˆì•½ì–´
            for (Member member : members) {
                out.write(" <tr>");
                out.write("     <td>" + member.getId() + "</td>");
                out.write("     <td>" + member.getUsername() + "</td>");
                out.write("     <td>" + member.getAge() + "</td>");
                out.write(" </tr>");
            }
        %>
        </tbody>
    </table>
</body>
</html>

```

### ì„œë¸”ë¦¿ê³¼ JSP ì˜ í•œê³„

#### ì„œë¸”ë¦¿

- ë·°(View) í™”ë©´ ê°œë°œì„ ìœ„í•œ HTML ì„ ë§Œë“œëŠ” ì‘ì—…ì´ JAVA ì½”ë“œì™€ ì„ì—¬ ë³µì¡
- ê·¸ë˜ì„œ ì´ë¥¼ JSP ë¥¼ ì‚¬ìš©í•˜ì—¬, HTML ì‘ì—…ì„ ê¹”ë”í•˜ê²Œ í•˜ê³  ì¤‘ê°„ë§ˆë‹¤ ë™ì ìœ¼ë¡œ ë³€ê²½ì´ í•„ìš”í•œ ë¶€ë¶„ì—ë§Œ JAVA ì‚¬ìš©

#### JSP

- íšŒì› ì €ì¥, ëª©ë¡ JSP
  - ì½”ë“œì˜ ìƒìœ„ ì ˆë°˜ì€ íšŒì› ì €ì¥/ëª©ë¡ì„ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
  - ë‚˜ë¨¸ì§€ í•˜ìœ„ ì ˆë°˜ë§Œ ê²°ê³¼ë¥¼ HTML ë¡œ ë³´ì—¬ì£¼ê¸° ìœ„í•œ ë·° ì˜ì—­
- JSP ê°€ ë„ˆë¬´ ë§ì€ ì—­í• ì„ í•¨. ìˆ˜ì²œ ìˆ˜ì²œ ì¤„ì´ ë„˜ì–´ê°€ëŠ” JSP ëŠ” ìœ ì§€ë³´ìˆ˜ì— ìˆì–´ì„œ ì§€ì˜¥

### MVC ì˜ ë“±ì¥

- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì„œë¸”ë¦¿ ì²˜ëŸ¼ ë‹¤ë¥¸ ê³³ì—ì„œ ì²˜ë¦¬, JSP ëŠ” ëª©ì ì— ë§ê²Œ HTML ë¡œ í™”ë©´(View) ê·¸ë¦¬ê¸°ì— ì§‘ì¤‘

## MVC íŒ¨í„´

### [ê°œìš”]

**ë„ˆë¬´ ë§ì€ ì—­í• **

- í•˜ë‚˜ì˜ ì„œë¸”ë¦¿, JSP ë§Œìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§, ë·° ë Œë”ë§ê¹Œì§€ ëª¨ë‘ ì²˜ë¦¬í•˜ë©´ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›Œì§„ë‹¤.

**â­ï¸ (ì¤‘ìš”) ë³€ê²½ì˜ ë¼ì´í”„ ì‚¬ì´í´**

- ì§„ì§œ ë¬¸ì œëŠ” ë‘˜ ì‚¬ì´ì— ë³€ê²½ì˜ ë¼ì´í”„ ì‚¬ì´í´ì´ ë‹¤ë¥´ë‹¤ëŠ” ì 

  - UI ë¥¼ ì¼ë¶€ ìˆ˜ì •í•˜ëŠ” ì¼ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜ì •í•˜ëŠ” ì¼ì€ ê°ê° ë‹¤ë¥´ê²Œ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ë†’ìŒ
  - ëŒ€ë¶€ë¶„ ì„œë¡œì—ê²Œ ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŒ

  :arrow_right: ë³€ê²½ì˜ ë¼ì´í”„ ì‚¬ì´í´ì´ ë‹¤ë¥¸ ë¶€ë¶„ì„ í•˜ë‚˜ì˜ ì½”ë“œë¡œ ê´€ë¦¬í•˜ëŠ” ê²ƒì€ ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì¢‹ì§€ ì•ŠìŒ

**ê¸°ëŠ¥ íŠ¹í™”**

- ë‹´ë‹¹í•˜ëŠ” ì—…ë¬´ë§Œ ìˆëŠ” ê²ƒì´ íš¨ê³¼ì 

**Model View Controller**

- ì„œë¸”ë¦¿ì´ë‚˜, JSP í•˜ë‚˜ë¡œ í•´ê²°í•˜ë˜ ê²ƒì„ <u>ì—­í• ì„ ë‚˜ëˆ ì¤€ ê²ƒ</u>

**ì»¨íŠ¸ë¡¤ëŸ¬** : HTTP ìš”ì²­ì„ ë°›ì•„ì„œ íŒŒë¼ë¯¸í„° ê²€ì¦, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰, ë·°ì— ì „ë‹¬í•  ê²°ê³¼ ë°ì´í„° ì¡°íšŒí•´ì„œ ëª¨ë¸ì— ë‹´ìŒ

**ëª¨ë¸** : ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë·°ì— ì¶œë ¥í•  ë°ì´í„°ë¥¼ ë‹´ì•„ë‘ . ë·°ê°€ í•„ìš”í•œ ë°ì´í„°ë¥¼ ëª¨ë‘ ëª¨ë¸ì— ë‹´ì•„ì„œ ì „ë‹¬í•´ì£¼ëŠ” ë•ë¶„ì— ë·°ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ë‚˜ ë°ì´í„° ì ‘ê·¼ ëª°ë¼ë„ ë˜ê³ , í™”ë©´ ë Œë”ë§ í•˜ëŠ” ì¼ì—ë§Œ ì§‘ì¤‘

**ë·°** : ëª¨ë¸ì´ ë‹´ê²¨ ìˆëŠ” ë°ì´í„° ì‚¬ìš©í•˜ì—¬ í™”ë©´ì„ ê·¸ë¦¬ëŠ” ì¼ì—ë§Œ ì§‘ì¤‘(HTML ì„ ìƒì„±í•˜ëŠ” ë¶€ë¶„)

> ì»¨íŠ¸ë¡¤ëŸ¬ì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë‘˜ ìˆ˜ ìˆì§€ë§Œ, ì´ëŸ¬ë©´ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë„ˆë¬´ ë§ì€ ì—­í•  ë‹´ë‹¹
>
> ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì„œë¹„ìŠ¤(Service) ë¼ëŠ” ê³„ì¸µì„ ë³„ë„ë¡œ ë§Œë“¤ì–´ì„œ ì²˜ë¦¬, ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìˆëŠ” ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹

#### MVC íŒ¨í„´2

1. í´ë¼ì´ì–¸íŠ¸ Controller(Servlet ìœ¼ë¡œ êµ¬í˜„) í˜¸ì¶œ
   - Controller ëŠ” HTTP ìš”ì²­ì´ ë§ëŠ”ì§€ ìŠ¤í™ í™•ì¸
2. Controller ì€ ì„œë¹„ìŠ¤, ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì´ìš©í•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§(Service ì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¡´ì¬)ì„ ì‹¤í–‰
3. Service ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì‹¤í–‰í•œ í›„, Model ì— ë°ì´í„°ë¥¼ ë‹´ì•„ì„œ ë°ì´í„° ì „ë‹¬
   - ì˜ˆ) íšŒì› ì¡°íšŒ ê²°ê³¼ ëª©ë¡ì„ model ì— ë‹´ìŒ(request.setAttribute ì‚¬ìš©)
   - ì—¬ê¸°ì„œ Model : HttpServletRequest ì—ì„œ setAttribute ë“±ìœ¼ë¡œ ë‚´ë¶€ ì €ì¥ì†Œë¥¼ í™œìš©
4. Controller ëŠ” View(JSP ë¡œ êµ¬í˜„) ë¡œì§ ìˆ˜í–‰
5. View ë¡œì§ì€ Model ì— ë‹´ê¸´ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ì—¬ View ë Œë”ë§?(ë§Œë“¦)
6. ì™„ì„±ëœ View ì‘ë‹µ

### [ì ìš©]

- ì„œë¸”ë¦¿ - Controller, JSP - View ë¡œ ì‚¬ìš©
- Model - HttpServletRequest ê°ì²´ ì‚¬ìš©
  - request ëŠ” ë‚´ë¶€ì— ë°ì´í„° ì €ì¥ì†Œë¥¼ ê°€ì§€ê³  ìˆëŠ”ë°, `request.setAttribute()`, `request.getAttribute()` ë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„° ë³´ê´€, ì¡°íšŒ ê°€ëŠ¥

#### íšŒì› ë“±ë¡

**íšŒì› ë“±ë¡ í¼ - ì»¨íŠ¸ë¡¤ëŸ¬**

```java
package hello.servlet.web.servletmvc;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

@WebServlet(name = "mvcMemberFormServlet", urlPatterns = "/servlet-mvc/members/new-form")
public class MvcMemberFormServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        String viewPath = "/WEB-INF/views/new-form.jsp";
        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, resp);
    }
}

```

 `req.getRequestDispatcher(viewPath);`

- Controller ì—ì„œ View ë¡œ ì´ë™í•  ë•Œ ì‚¬ìš©

`dispatcher.forward(req, resp);`

- ë‹¤ë¥¸ ì„œë¸”ë¦¿ì´ë‚˜ JSP ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥, ì„œë²„ ë‚´ë¶€ì—ì„œ ë‹¤ì‹œ í˜¸ì¶œì´ ë°œìƒ(í•¨ìˆ˜ í˜¸ì¶œí•˜ë“¯ì´)
- í˜¸ì¶œí•˜ë©´, servlet ì—ì„œ JSP í˜¸ì¶œ ê°€ëŠ¥
- JSP ê²½ë¡œë¥¼ ì°¾ì•„ ë„˜ì–´ê°€ì„œ í˜¸ì¶œë˜ê³ , ê·¸ëŸ¼ ì„œë²„ ë‚´ë¶€ë¼ë¦¬ ë‚´ë¶€ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²ƒ(ì œì–´ê¶Œì„ ë„˜ê²¨ì£¼ëŠ” ê²ƒ)

**â­ï¸ (ì¤‘ìš”) ì„œë²„ ë‚´ë¶€ì—ì„œ ë‹¤ì‹œ í˜¸ì¶œì´ ëœë‹¤ëŠ” ì˜ë¯¸**

- Client ì™€ ì™”ë‹¤ê°”ë‹¤ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, Client ì—ì„œ Server ìš”ì²­ í›„ Server ë‚´ë¶€ì—ì„œ ìê¸°ë“¤ë¼ë¦¬ Servlet ì„ í˜¸ì¶œí–ˆë‹¤ê°€ JSP í˜¸ì¶œí•˜ê³  ì‘ë‹µ ë§Œë“¤ì–´ì„œ ë³´ë‚´ëŠ” ê²ƒ

> redirct vs foward
>
> ë¦¬ë‹¤ì´ë ‰íŠ¸ëŠ” ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸(ì›¹ ë¸Œë¼ìš°ì €)ì— ì‘ë‹µì´ ë‚˜ê°”ë‹¤ê°€, í´ë¼ì´ì–¸íŠ¸ê°€ redirect ê²½ë¡œë¡œ ë‹¤ì‹œ ìš”ì²­. ë”°ë¼ì„œ í´ë¼ì´ì–¸íŠ¸ê°€ ì¸ì§€í•  ìˆ˜ ìˆê³  URL ê²½ë¡œë„ ì‹¤ì œë¡œ ë³€ê²½
>
> í¬ì›Œë“œëŠ” ì„œë²„ ë‚´ë¶€ì—ì„œ ì¼ì–´ë‚˜ëŠ” í˜¸ì¶œì´ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ê°€ ì „í˜€ ì¸ì§€í•˜ì§€ ëª»í•¨

**íšŒì› ë“±ë¡ í¼ - ë·°**

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<%-- ìƒëŒ€ ê²½ë¡œ ì‚¬ìš©, [í˜„ì¬ URL ì´ ì†í•œ ê³„ì¸µ ê²½ë¡œ + /save] --%>
<form action="save" method="post">
    username: <input type="text" name="username" />
    age: <input type="text" name="age" />
    <button type="submit">ì „ì†¡</button>
</form>
</body>
</html>
```

form ì˜ actionì„ ë³´ë©´ ì ˆëŒ€ ê²½ë¡œ(/ë¡œ ì‹œì‘)ê°€ ì•„ë‹ˆë¼ ìƒëŒ€ê²½ë¡œ(/ë¡œ ì‹œì‘ X)ë¡œ ì‹œì‘

- ìƒëŒ€ ê²½ë¡œ ì‚¬ìš©í•˜ë©´ í¼ ì „ì†¡ ì‹œ í˜„ì¬ URL ì´ ì†í•œ ê³„ì¸µ ê²½ë¡œ + save ê°€ í˜¸ì¶œë¨

#### íšŒì› ì €ì¥

**íšŒì› ì €ì¥ - ì»¨íŠ¸ë¡¤ëŸ¬**

```java
package hello.servlet.web.servletmvc;

import hello.servlet.domain.member.Member;
import hello.servlet.domain.member.MemberRepository;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

@WebServlet(name = "mvcMemberSaveServlet", urlPatterns = "/servlet-mvc/members/save")
public class MvcMemberSaveServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        String username = req.getParameter("username");
        int age = Integer.parseInt(req.getParameter("age"));

        Member member = new Member(username, age);
        System.out.println("member = " + member);
        memberRepository.save(member);

        // Model ì— ë°ì´í„° ë³´ê´€
        req.setAttribute("member", member);

        String viewPath = "/WEB-INF/views/save-result.jsp";
        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, resp);
    }
}

```

MvcMemberSaveServlet ì€ íŒŒë¼ë¯¸í„° ë°›ê³ , ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í˜¸ì¶œí•˜ê³ , model ì— ë°ì´í„° ë‹´ê³ , view ë¡œ ë˜ì§€ëŠ” controller ì—­í•  ì•„ì£¼ ì˜ ìˆ˜í–‰

`req.setAttribute("member", member);`

- HttpServletRequest ë¥¼ Model ë¡œ ì‚¬ìš©
- ë·°ëŠ” `req.getAttribute()` ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„° êº¼ë‚´ë©´ ë¨

**íšŒì› ì €ì¥ - ë·°**

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <meta charset="UTF-8">
</head>
<body>
ì„±ê³µ
<ul>
    <li>id=${member.id}</li>
    <li>username=${member.username}</li>
    <li>age=${member.age}</li>
</ul>
<a href="/index.html">ë©”ì¸</a>
</body>
</html>
```

`<%= request.getAttribute("member"%>` ë¡œ ëª¨ë¸ì— ì €ì¥í•œ member ê°ì²´ë¥¼ êº¼ë‚¼ ìˆ˜ ìˆì§€ë§Œ, ë„ˆë¬´ ë³µì¡

- JSP `${ }` ë¬¸ë²•(í”„ë¡œí¼í‹° ì ‘ê·¼ë²•) ì œê³µí•˜ëŠ”ë°, ì´ ë¬¸ë²• ì‚¬ìš©í•˜ë©´ request ì˜ attribute ì— ë‹´ê¸´ ë°ì´í„°ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆìŒ

#### íšŒì› ëª©ë¡ ì¡°íšŒ

**íšŒì› ëª©ë¡ ì¡°íšŒ - ì»¨íŠ¸ë¡¤ëŸ¬**

```java
package hello.servlet.web.servletmvc;

import hello.servlet.domain.member.Member;
import hello.servlet.domain.member.MemberRepository;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;
import java.util.List;

@WebServlet(name = "mvcMemberListServlet", urlPatterns = "/servlet-mvc/members")
public class MvcMemberListServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        System.out.println("MvcMemberListServlet.service");
        List<Member> members = memberRepository.findAll();

        req.setAttribute("members", members);

        String viewPath = "/WEB-INF/views/members.jsp";
        RequestDispatcher dispatcher = req.getRequestDispatcher(viewPath);
        dispatcher.forward(req, resp);

    }
}

```

request ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ `List<Member> members` ë¥¼ ëª¨ë¸ì— ë³´ê´€

**íšŒì› ëª©ë¡ ì¡°íšŒ - ë·°**

```jsp
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%--
  Created by IntelliJ IDEA.
  User: onam-ui
  Date: 24. 9. 15.
  Time: ì˜¤í›„ 3:54
  To change this template use File | Settings | File Templates.
--%>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<a href="/index.html">ë©”ì¸</a>
<table>
    <thead>
    <th>id</th>
    <th>username</th>
    <th>age</th>
    </thead>
    <tbody>
    <c:forEach var="item" items="${members}">
        <tr>
            <td>${item.id}</td>
            <td>${item.username}</td>
            <td>${item.age}</td>
        </tr>
    </c:forEach>
    </tbody>
</table>
</body>
</html>

```

`<c:forEach var="item" items="${members}">`

- JSTL ì´ë¼ëŠ” ê¸°ëŠ¥. íŠ¹ë³„í•œ íƒœê·¸ë“¤ ì œê³µ, ë°˜ë³µë˜ëŠ” ë¡œì§ì„ íƒœê·¸ë¡œ í•´ê²° ê°€ëŠ¥
- `<c:forEach>` ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì„ ì–¸ë„ í•´ì¤˜ì•¼ í•¨

##### ì—¬ê¸°ì„œ ì ê¹! ğŸ¤” ì—¬ê¸°ì„œ ë­”ê°€ ë°˜ë³µì´ ìˆê³ , ë” ê°œì„ í•˜ê³  ì‹¶ë‹¤!

### [í•œê³„]

ì •í™•íˆ ë§í•˜ë©´, ì„œë¸”ë¦¿ê³¼ JSP ë¡œ ë§Œë“  MVC íŒ¨í„´

- MVC íŒ¨í„´ì„ ì ìš©í•˜ì—¬ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì—­í• ê³¼ ë·°ë¥¼ ë Œë”ë§ í•˜ëŠ” ì—­í• ì„ ëª…í™•í•˜ê²Œ êµ¬ë¶„í•¨
- íŠ¹íˆ ë·°ëŠ” í™”ë©´ì„ ê·¸ë¦¬ëŠ” ì—­í• ì— ì¶©ì‹¤í•œ ë•ë¶„ì—, ì½”ë“œê°€ ê¹”ë”í•˜ê³  ì§ê´€ì , ëª¨ë¸ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ êº¼ë‚´ê³  í™”ë©´ë§Œ ë§Œë“¤ë©´ ë¨
- ê·¸ëŸ¬ë‚˜, êµ¬í˜„í•˜ë©´ í•  ìˆ˜ë¡ ì»¨íŠ¸ë¡¤ëŸ¬ ë¶€ë¶„ì´ ì¤‘ë³µì´ ë§ê³ , í•„ìš”í•˜ì§€ ì•Šì€ ì½”ë“œë„ ë§ì´ ë³´ì„

**MVC ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë‹¨ì **

<í¬ì›Œë“œ ì¤‘ë³µ>

- View ë¡œ ì´ë™í•˜ëŠ” ì½”ë“œê°€ í•­ìƒ ì¤‘ë³µ í˜¸ì¶œ
  - ì´ ë¶€ë¶„ì„ ë©”ì„œë“œë¡œ ê³µí†µí™”í•´ë„ ë˜ì§€ë§Œ, ì´ ë˜í•œ ì§ì ‘ í˜¸ì¶œ

<ViewPathì— ì¤‘ë³µ>

- Prefix: /WEB-INF/views/
- Suffix: .jsp

ë§Œì•½ jsp ê°€ ì•„ë‹ˆë¼, thymeleaf ë¡œ ë°”ë€Œë©´ ì „ì²´ ì½”ë“œ ì‹¹ ë°”ê¿”ì•¼ í•¨

<ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œ>

HttpServletRequest, HttpServletResponse

- ì‚¬ìš©í•  ë•Œë„ ìˆê³ , ì‚¬ìš©í•˜ì§€ ì•Šì„ ë•Œë„ ìˆìŒ
- ê·¸ë¦¬ê³  HttpServletRequest, HttpServletResponse ë¥¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±í•˜ê¸° ì–´ë ¤ì›€

<ê³µí†µ ì²˜ë¦¬ê°€ ì–´ë µë‹¤>

ì˜ˆ) ë¡œê·¸ ì¶œë ¥ ë“± ê³µí†µ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•  ê²ƒ ê°™ì€ ê²ƒë“¤ì„ í•´ê²°í•˜ê³ ì í•¨

- ê¸°ëŠ¥ì´ ë³µì¡í•´ì§ˆ ìˆ˜ë¡ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ ë” ë§ì´ ì¦ê°€í•  ê²ƒ

ì¦‰, **ê³µí†µì²˜ë¦¬ê°€ ì–´ë µë‹¤ëŠ” ë¬¸ì œ** ì¡´ì¬

- ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ì„œëŠ” Controller(Servlet) ìì²´ í˜¸ì¶œ ì „ì— ë¨¼ì € ê³µí†µ ê¸°ëŠ¥ ì²˜ë¦¬
- ì†Œìœ„ ìˆ˜ë¬¸ì¥ ì—­í• ì„ í•˜ëŠ” ê¸°ëŠ¥ì´ í•„ìš”(ì…êµ¬ë¥¼ í•˜ë‚˜ë¡œ!)
- **í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬** íŒ¨í„´ì„ ë„ì…í•˜ë©´ ì´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
- ìŠ¤í”„ë§ MVC ì˜ í•µì‹¬ë„ ë°”ë¡œ ì´ **í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ **

> controller vs filter
>
> í•„í„°ëŠ” ì •í•´ì§„ ìŠ¤í™ëŒ€ë¡œ chain ì­‰ ì§„í–‰
>
> ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì›í•˜ëŠ”ëŒ€ë¡œ ì¡°ì‘ ê°€ëŠ¥

---

ì¶œì²˜ : https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-1